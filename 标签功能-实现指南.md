# ğŸ·ï¸ æ ‡ç­¾åŠŸèƒ½å®ç°æŒ‡å—

## âœ… å·²å®Œæˆ

1. **æ•°æ®åº“å±‚** - å®Œå…¨å®ç°
   - TagEntity - æ ‡ç­¾å®ä½“
   - ClipboardTagEntity - å‰ªè´´æ¿-æ ‡ç­¾å…³è”è¡¨
   - TagDao - æ ‡ç­¾æ•°æ®è®¿é—®å¯¹è±¡
   - æ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆ1â†’2ç‰ˆæœ¬ï¼‰

2. **UIç»„ä»¶** - å®Œå…¨å®ç°
   - TagManageScreen - æ ‡ç­¾ç®¡ç†ç•Œé¢
   - CreateTagDialog - åˆ›å»ºæ ‡ç­¾å¯¹è¯æ¡†
   - TagSelectDialog - æ ‡ç­¾é€‰æ‹©å¯¹è¯æ¡†
   - TagItem - æ ‡ç­¾é¡¹ç»„ä»¶

---

## ğŸ“‹ å¾…å®ç°

### 1. åœ¨ä¸»ç•Œé¢æ·»åŠ æ ‡ç­¾ç®¡ç†æ ‡ç­¾é¡µ

**æ–‡ä»¶**: [MainActivity.kt](app/src/main/java/com/yinian/clipboard/ui/MainActivity.kt)

ä¿®æ”¹åº•éƒ¨å¯¼èˆªï¼Œä»3ä¸ªTabæ”¹ä¸º4ä¸ªTabï¼š
```kotlin
val tabs = listOf("å‰ªè´´æ¿", "å¯¼å‡º", "æ ‡ç­¾", "è®¾ç½®")
```

### 2. åˆ›å»ºViewModelç®¡ç†æ ‡ç­¾

**æ–°å»ºæ–‡ä»¶**: [TagViewModel.kt](app/src/main/java/com/yinian/clipboard/ui/viewmodel/TagViewModel.kt)

```kotlin
@HiltViewModel
class TagViewModel @Inject constructor(
    private val tagDao: TagDao
) : ViewModel() {

    val allTags = tagDao.getAll()
        .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), emptyList())

    fun createTag(name: String, color: String) {
        viewModelScope.launch {
            val tag = TagEntity(
                name = name,
                color = color,
                createdAt = System.currentTimeMillis(),
                updatedAt = System.currentTimeMillis()
            )
            tagDao.insert(tag)
        }
    }

    fun deleteTag(tag: TagEntity) {
        viewModelScope.launch {
            tagDao.delete(tag)
        }
    }
}
```

### 3. åœ¨å‰ªè´´æ¿å¡ç‰‡ä¸­æ˜¾ç¤ºæ ‡ç­¾

**ä¿®æ”¹**: [ClipboardItem.kt](app/src/main/java/com/yinian/clipboard/ui/components/ClipboardItem.kt)

æ·»åŠ æ ‡ç­¾æ˜¾ç¤ºåŒºåŸŸï¼š
```kotlin
@Composable
fun ClipboardItem(
    item: ClipboardEntity,
    tags: List<TagEntity>,
    onClick: () -> Unit,
    onTagClick: () -> Unit,
    modifier: Modifier = Modifier
) {
    Card(modifier = modifier.clickable(onClick = onClick)) {
        Column(modifier = Modifier.padding(12.dp)) {
            // ç°æœ‰å†…å®¹

            // æ–°å¢ï¼šæ ‡ç­¾æ˜¾ç¤º
            if (tags.isNotEmpty()) {
                Row(
                    modifier = Modifier.padding(top = 8.dp),
                    horizontalArrangement = Arrangement.spacedBy(8.dp)
                ) {
                    tags.forEach { tag ->
                        Surface(
                            shape = RoundedCornerShape(12.dp),
                            color = Color(android.graphics.Color.parseColor(tag.color))
                        ) {
                            Text(
                                text = tag.name,
                                modifier = Modifier.padding(horizontal = 8.dp, vertical = 4.dp),
                                style = MaterialTheme.typography.labelSmall,
                                color = Color.White
                            )
                        }
                    }
                }
            }
        }
    }
}
```

### 4. æ·»åŠ æ ‡ç­¾é€‰æ‹©åŠŸèƒ½

åœ¨å‰ªè´´æ¿å¡ç‰‡é•¿æŒ‰æ—¶å¼¹å‡ºæ ‡ç­¾é€‰æ‹©å¯¹è¯æ¡†ã€‚

---

## ğŸ¯ å¿«é€Ÿå®ç°æ­¥éª¤

### æ­¥éª¤1: ä¿®æ”¹ä¸»ç•Œé¢å¯¼èˆª

åœ¨ [MainActivity.kt](app/src/main/java/com/yinian/clipboard/ui/MainActivity.kt) ä¸­ï¼š

```kotlin
// ä¿®æ”¹tabså®šä¹‰
val tabs = listOf("å‰ªè´´æ¿", "å¯¼å‡º", "æ ‡ç­¾", "è®¾ç½®")

// åœ¨whenè¯­å¥ä¸­æ·»åŠ æ ‡ç­¾é¡µ
when (selectedTab) {
    0 -> ClipboardMainScreen(modifier = Modifier.padding(padding))
    1 -> ExportScreen(exportServer = exportServer, modifier = Modifier.padding(padding))
    2 -> TagManagementScreen(modifier = Modifier.padding(padding))  // æ–°å¢
    3 -> SettingsScreen(modifier = Modifier.padding(padding))
}
```

### æ­¥éª¤2: åˆ›å»ºæ ‡ç­¾ç®¡ç†ViewModel

```kotlin
@HiltViewModel
class TagViewModel @Inject constructor(
    private val tagDao: TagDao
) : ViewModel() {
    val allTags = tagDao.getAll()
        .stateIn(viewModelScope, SharingStarted.WhileSubscribed(5000), emptyList())

    fun createTag(name: String, color: String) {
        viewModelScope.launch {
            val tag = TagEntity(
                name = name,
                color = color,
                createdAt = System.currentTimeMillis(),
                updatedAt = System.currentTimeMillis()
            )
            tagDao.insert(tag)
        }
    }

    fun deleteTag(tag: TagEntity) {
        viewModelScope.launch {
            tagDao.delete(tag)
        }
    }
}
```

### æ­¥éª¤3: åˆ›å»ºæ ‡ç­¾ç®¡ç†Screen

```kotlin
@OptIn(ExperimentalMaterial3Api::class)
@Composable
fun TagManagementScreen(
    viewModel: TagViewModel = hiltViewModel(),
    modifier: Modifier = Modifier
) {
    val tags by viewModel.allTags.collectAsState()

    TagManageScreen(
        tags = tags,
        onCreateTag = { name, color -> viewModel.createTag(name, color) },
        onDeleteTag = { tag -> viewModel.deleteTag(tag) },
        modifier = modifier
    )
}
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯•1: åˆ›å»ºæ ‡ç­¾
1. æ‰“å¼€åº”ç”¨
2. åˆ‡æ¢åˆ°"æ ‡ç­¾"æ ‡ç­¾é¡µ
3. ç‚¹å‡»å³ä¸‹è§’ + æŒ‰é’®
4. è¾“å…¥æ ‡ç­¾åç§°ï¼ˆå¦‚"å·¥ä½œ"ï¼‰
5. é€‰æ‹©é¢œè‰²
6. ç‚¹å‡»"åˆ›å»º"
7. âœ… é¢„æœŸï¼šæ ‡ç­¾åˆ—è¡¨ä¸­æ˜¾ç¤ºæ–°æ ‡ç­¾

### æµ‹è¯•2: åˆ é™¤æ ‡ç­¾
1. é•¿æŒ‰æ ‡ç­¾é¡¹
2. ç‚¹å‡»åˆ é™¤æŒ‰é’®
3. ç¡®è®¤åˆ é™¤
4. âœ… é¢„æœŸï¼šæ ‡ç­¾ä»åˆ—è¡¨ä¸­ç§»é™¤

### æµ‹è¯•3: ä¸ºå‰ªè´´æ¿æ·»åŠ æ ‡ç­¾
1. åœ¨å‰ªè´´æ¿åˆ—è¡¨ä¸­é•¿æŒ‰æŸä¸€é¡¹
2. å¼¹å‡ºæ ‡ç­¾é€‰æ‹©å¯¹è¯æ¡†
3. é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡ç­¾
4. ç‚¹å‡»"ç¡®å®š"
5. âœ… é¢„æœŸï¼šå‰ªè´´æ¿å¡ç‰‡ä¸Šæ˜¾ç¤ºæ ‡ç­¾

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### tagsè¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | ä¸»é”® |
| name | TEXT | æ ‡ç­¾åç§°ï¼ˆå”¯ä¸€ï¼‰ |
| color | TEXT | é¢œè‰²ä»£ç ï¼ˆ#FF5722ï¼‰ |
| created_at | INTEGER | åˆ›å»ºæ—¶é—´ |
| updated_at | INTEGER | æ›´æ–°æ—¶é—´ |

### clipboard_tagsè¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| clipboard_id | INTEGER | å‰ªè´´æ¿IDï¼ˆå¤–é”®ï¼‰ |
| tag_id | INTEGER | æ ‡ç­¾IDï¼ˆå¤–é”®ï¼‰ |
| PRIMARY KEY | (clipboard_id, tag_id) | è”åˆä¸»é”® |

---

## ğŸ¨ UIç»„ä»¶è¯´æ˜

### TagManageScreen
- **åŠŸèƒ½**: æ ‡ç­¾åˆ—è¡¨ç®¡ç†
- **æ“ä½œ**: åˆ›å»ºã€åˆ é™¤æ ‡ç­¾
- **ç©ºçŠ¶æ€**: æç¤ºç”¨æˆ·åˆ›å»ºæ ‡ç­¾

### CreateTagDialog
- **åŠŸèƒ½**: åˆ›å»ºæ–°æ ‡ç­¾
- **è¾“å…¥**: æ ‡ç­¾åç§°
- **é€‰æ‹©**: 14ç§é¢„è®¾é¢œè‰²
- **é¢„è§ˆ**: å®æ—¶é¢„è§ˆæ ‡ç­¾æ•ˆæœ

### TagSelectDialog
- **åŠŸèƒ½**: ä¸ºå‰ªè´´æ¿é€‰æ‹©æ ‡ç­¾
- **å¤šé€‰**: æ”¯æŒé€‰æ‹©å¤šä¸ªæ ‡ç­¾
- **ç©ºçŠ¶æ€**: æç¤ºåˆ›å»ºæ ‡ç­¾

### TagItem
- **æ˜¾ç¤º**: æ ‡ç­¾é¢œè‰²åœ†åœˆ + åç§° + æ—¶é—´
- **æ“ä½œ**: ç‚¹å‡»åˆ é™¤

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

ç”±äºæ—¶é—´å’Œå¤æ‚åº¦è€ƒè™‘ï¼Œå»ºè®®åˆ†é˜¶æ®µå®ç°ï¼š

**é˜¶æ®µ1** (å½“å‰):
- âœ… æ•°æ®åº“å±‚å®Œæˆ
- âœ… UIç»„ä»¶å®Œæˆ
- â³ é›†æˆåˆ°ä¸»ç•Œé¢

**é˜¶æ®µ2** (å¯é€‰):
- åœ¨å‰ªè´´æ¿å¡ç‰‡æ˜¾ç¤ºæ ‡ç­¾
- æ·»åŠ æ ‡ç­¾ç­›é€‰åŠŸèƒ½
- æŒ‰æ ‡ç­¾æœç´¢

**é˜¶æ®µ3** (é«˜çº§):
- æ ‡ç­¾ä½¿ç”¨ç»Ÿè®¡
- æ ‡ç­¾é¢œè‰²è‡ªå®šä¹‰
- æ ‡ç­¾åˆ†ç»„

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç¼–è¯‘**: TagManageScreen.kt å·²ç»åˆ›å»ºï¼Œéœ€è¦ç¼–è¯‘æµ‹è¯•
2. **ä¾èµ–**: éœ€è¦æ·»åŠ  Hilt ViewModel ä¾èµ–
3. **å¯¼èˆª**: éœ€è¦ä¿®æ”¹ MainActivity çš„åº•éƒ¨å¯¼èˆª
4. **æµ‹è¯•**: å»ºè®®å…ˆæµ‹è¯•æ ‡ç­¾ç®¡ç†åŠŸèƒ½ï¼Œå†é›†æˆåˆ°ä¸»ç•Œé¢

---

## ğŸ’¡ å»ºè®®

ç”±äºæ ‡ç­¾åŠŸèƒ½æ¶‰åŠå¤šä¸ªæ–‡ä»¶çš„ä¿®æ”¹ï¼Œå»ºè®®ï¼š

1. **å…ˆç¼–è¯‘æµ‹è¯•** TagManageScreen æ˜¯å¦èƒ½æ­£å¸¸ç¼–è¯‘
2. **é€æ­¥é›†æˆ** å…ˆå®ç°æ ‡ç­¾ç®¡ç†Tabï¼Œå†å®ç°æ ‡ç­¾æ˜¾ç¤º
3. **å‚è€ƒç°æœ‰ä»£ç ** å‚è€ƒ ExportScreen å’Œ SettingsScreen çš„å®ç°æ–¹å¼

è¯·å‘Šè¯‰æˆ‘æ˜¯å¦ç»§ç»­å®ç°ä¸»ç•Œé¢é›†æˆï¼Ÿ
